# 六趣DNS 使用教程

## 环境要求

- Linux 服务器（CentOS/Ubuntu/Debian）
- Docker 已安装
- MySQL 数据库

## 安装前准备

### 1. 安装 Docker

如果未安装 Docker，请先安装：

```bash
# CentOS
curl -fsSL https://get.docker.com | bash

# 启动 Docker
systemctl start docker
systemctl enable docker
```

### 2. 准备 MySQL 数据库

请提前创建好数据库和用户：

```sql
-- 登录 MySQL
mysql -u root -p

-- 创建数据库
CREATE DATABASE liuqu_dns CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 创建用户并授权
CREATE USER 'liuqu_dns'@'localhost' IDENTIFIED BY '你的密码';
GRANT ALL PRIVILEGES ON liuqu_dns.* TO 'liuqu_dns'@'localhost';
FLUSH PRIVILEGES;
```

## 一键安装

运行以下命令：

```bash
curl -fsSL https://6qu.cc/dns2/install.sh | bash
```

脚本会自动：
1. 检测 Docker 环境
2. 中国服务器自动配置镜像加速
3. 显示交互式菜单

## 菜单说明

```
========================================
       六趣DNS 管理脚本                 
========================================

  1. 安装
  2. 更新
  3. 卸载
  0. 退出

========================================
```

### 1. 安装

选择 `1` 后，按提示输入数据库信息：

- 数据库地址（默认 127.0.0.1）
- 数据库端口（默认 3306）
- 数据库名称（默认 liuqu_dns）
- 数据库用户名（默认 liuqu_dns）
- 数据库密码（必填）

安装完成后访问：`http://服务器IP:5000`

### 2. 更新

选择 `2` 会自动拉取最新镜像并重启容器，配置文件不会丢失。

### 3. 卸载

选择 `3` 会停止容器并删除安装目录（包括配置文件）。

## 配置文件

安装目录：`/opt/dns`

- `docker-compose.yml` - Docker 配置
- `.env` - 环境变量配置

### 修改配置

```bash
cd /opt/dns
vim .env
docker-compose restart
```

## 常用命令

```bash
# 查看容器状态
docker ps

# 查看日志
docker logs dns-app

# 重启容器
cd /opt/dns && docker-compose restart

# 停止容器
cd /opt/dns && docker-compose down

# 启动容器
cd /opt/dns && docker-compose up -d
```

## 常见问题

### 1. 数据库连接失败

确保 MySQL 用户有正确的访问权限，如果使用 `127.0.0.1` 连接，用户需要有本地访问权限。

### 2. 端口被占用

修改 `.env` 文件中的 `HOST_PORT`：

```bash
HOST_PORT=8080
```

然后重启容器。

### 3. 容器启动失败

查看日志排查问题：

```bash
docker logs dns-app
```

## 技术支持

QQ群：1070970571
