# 使用指南

## 初始配置

首次部署后，按以下步骤完成初始配置：

### 1. 修改管理员密码

1. 访问 http://服务器IP:5000/admin
2. 使用默认账号登录：`admin@qq.com` / `admin123`
3. 进入 **用户管理** → 找到管理员账户 → **编辑** → 修改密码

### 2. 添加DNS渠道

1. 进入 **渠道管理** → **添加渠道**
2. 选择DNS服务商类型
3. 填写凭据信息（参考下方各服务商配置）
4. 点击 **验证凭据** 确认配置正确
5. 保存渠道

### 3. 添加主域名

1. 进入 **域名管理** → **添加域名**
2. 选择已添加的渠道
3. 从渠道获取域名列表，选择要添加的域名
4. 设置域名描述（可选）
5. 保存域名

### 4. 创建套餐

1. 进入 **套餐管理** → **添加套餐**
2. 选择关联的域名（可多选）
3. 设置套餐名称、价格、有效期
4. 设置域名前缀长度限制
5. 设置最大DNS记录数
6. 保存套餐

---

## DNS渠道管理

系统支持13种DNS服务商，每种服务商需要不同的凭据配置。

### Cloudflare

| 字段 | 说明 |
|------|------|
| email | Cloudflare账户邮箱 |
| auth_type | 认证方式：`api_key` 或 `api_token` |
| api_key | Global API Key（api_key方式） |
| api_token | API Token（api_token方式） |

**获取方式**：
1. 登录 Cloudflare Dashboard
2. 点击右上角头像 → **My Profile** → **API Tokens**
3. 查看 **Global API Key** 或创建 **API Token**

### 阿里云DNS

| 字段 | 说明 |
|------|------|
| access_key_id | AccessKey ID |
| access_key_secret | AccessKey Secret |

**获取方式**：
1. 登录阿里云控制台
2. 点击右上角头像 → **AccessKey管理**
3. 创建或查看AccessKey

### 腾讯云DNSPod

| 字段 | 说明 |
|------|------|
| secret_id | SecretId |
| secret_key | SecretKey |

**获取方式**：
1. 登录腾讯云控制台
2. 进入 **访问管理** → **API密钥管理**
3. 创建或查看密钥

### 华为云DNS

| 字段 | 说明 |
|------|------|
| ak | Access Key |
| sk | Secret Key |
| region | 区域（如 cn-north-4） |

### 西部数码

| 字段 | 说明 |
|------|------|
| username | 账户用户名 |
| api_password | API密码 |

### AWS Route53

| 字段 | 说明 |
|------|------|
| access_key_id | AWS Access Key ID |
| secret_access_key | AWS Secret Access Key |
| region | 区域（如 us-east-1） |

### GoDaddy

| 字段 | 说明 |
|------|------|
| api_key | API Key |
| api_secret | API Secret |

### Namecheap

| 字段 | 说明 |
|------|------|
| api_user | API用户名 |
| api_key | API Key |

### Name.com

| 字段 | 说明 |
|------|------|
| username | 用户名 |
| token | API Token |

### 百度智能云

| 字段 | 说明 |
|------|------|
| access_key | Access Key |
| secret_key | Secret Key |

### NameSilo

| 字段 | 说明 |
|------|------|
| api_key | API Key |

### 六趣DNS（分销模式）

| 字段 | 说明 |
|------|------|
| api_url | 上游六趣DNS的API地址 |
| api_key | API Key |
| api_secret | API Secret |

**说明**：用于对接其他六趣DNS实例，实现分销模式。

### PowerDNS

| 字段 | 说明 |
|------|------|
| api_url | PowerDNS API地址 |
| api_key | API Key |
| server_id | 服务器ID（默认 localhost） |

**说明**：用于对接自建的PowerDNS服务器。

---

## 域名管理

### 主域名管理

- **添加域名**：从渠道获取域名列表，选择要添加的域名
- **编辑域名**：修改描述、开放注册状态
- **删除域名**：删除主域名会同时删除所有二级域名和DNS记录

### 二级域名管理

- **查看列表**：支持按用户、主域名、状态筛选
- **编辑域名**：修改状态、到期时间、延期天数
- **删除域名**：删除二级域名会同时删除Cloudflare上的DNS记录
- **查看DNS记录**：查看该二级域名的所有DNS解析记录

---

## 套餐管理

### 创建套餐

| 字段 | 说明 |
|------|------|
| 套餐名称 | 显示给用户的名称 |
| 关联域名 | 可选择多个域名 |
| 价格 | 购买价格，0为免费 |
| 有效期 | 天数，-1为永久 |
| 最小长度 | 域名前缀最小字符数 |
| 最大长度 | 域名前缀最大字符数 |
| 最大记录数 | DNS记录数量限制，-1为无限 |
| 描述 | 套餐说明 |

### 套餐排序

通过 **排序值** 字段控制套餐显示顺序，数值越小越靠前。

---

## 用户管理

### 用户列表

- 支持搜索用户名、邮箱
- 支持按状态筛选
- 显示OAuth绑定状态（GitHub/Google/NodeLoc）

### 用户操作

- **编辑**：修改用户名、邮箱、状态、角色、域名配额、余额
- **重置密码**：为用户设置新密码
- **调整余额**：增加或减少用户余额
- **解绑OAuth**：解除用户的第三方登录绑定
- **删除**：删除用户及其所有域名和DNS记录

---

## 卡密管理

### 批量生成

1. 进入 **卡密管理** → **批量生成**
2. 设置充值金额（-1为无限余额）
3. 设置生成数量（1-100）
4. 设置过期天数（可选）
5. 点击生成

### 导出卡密

点击 **导出** 按钮，下载未使用的卡密列表。

### 卡密状态

- **未使用**：可正常使用
- **已使用**：已被用户充值
- **已禁用**：管理员手动禁用

---

## 优惠券管理

### 创建优惠券

| 字段 | 说明 |
|------|------|
| 名称 | 优惠券名称 |
| 优惠码 | 不填则自动生成 |
| 类型 | percent（折扣）或 fixed（固定金额） |
| 优惠值 | 折扣百分比或固定金额 |
| 最低消费 | 使用门槛 |
| 总数量 | -1为无限 |
| 每人限用 | 每个用户可使用次数 |
| 适用产品 | 全部、域名、虚拟主机 |
| 排除域名 | 不能使用此优惠券的域名 |

---

## 公告系统

### 发布公告

| 字段 | 说明 |
|------|------|
| 标题 | 公告标题 |
| 内容 | 支持HTML格式 |
| 类型 | info/warning/success/error |
| 置顶 | 是否置顶显示 |
| 弹窗 | 是否弹窗显示 |
| 状态 | 草稿或发布 |

---

## 邮件模板

系统支持自定义以下邮件模板：

| 模板 | 说明 |
|------|------|
| 注册验证 | 用户注册时发送的验证邮件 |
| 重置密码 | 找回密码时发送的邮件 |
| 邮箱变更 | 修改邮箱时发送的验证邮件 |
| 域名到期提醒 | 域名即将到期时的提醒邮件 |
| 域名删除通知 | 域名被删除时的通知邮件 |
| 自动续费成功 | 自动续费成功的通知邮件 |
| 自动续费失败 | 自动续费失败的通知邮件 |

### 模板变量

模板中可使用以下变量：

- `{site_name}` - 站点名称
- `{username}` - 用户名
- `{domain}` - 域名
- `{expires_at}` - 到期时间
- `{verify_url}` - 验证链接

---

## 系统设置

### 站点信息

- 站点名称、描述、Logo、Favicon
- 备案号
- 管理员邮箱
- 站点URL

### 注册设置

- 开放/关闭注册
- 新用户默认域名配额
- 邮箱后缀限制（白名单/黑名单模式）

### SMTP邮件

- SMTP服务器地址和端口
- 用户名和密码
- SSL/TLS设置
- 发件人名称

### 阿里云邮件推送

- 启用/禁用
- Access Key配置
- 区域选择
- 发信地址

### 验证码设置

- Cloudflare Turnstile配置
- 各场景验证码开关（登录、注册、找回密码等）

### OAuth登录

- GitHub OAuth配置
- Google OAuth配置
- NodeLoc OAuth配置

### 网站统计

- 支持百度统计、Google Analytics等统计代码

---

## 虚拟主机分发

虚拟主机分发模块通过宝塔面板API自动化创建和管理虚拟主机。

### 服务器管理

1. 进入 **虚拟主机管理** → **服务器管理**
2. 添加宝塔面板服务器
3. 填写面板地址和API Key
4. 测试连接

### 套餐管理

| 字段 | 说明 |
|------|------|
| 套餐名称 | 显示名称 |
| 价格 | 购买价格 |
| 有效期 | 天数 |
| 磁盘空间 | MB |
| 月流量 | MB，-1为无限 |
| 域名数 | 可绑定域名数量 |
| 数据库数 | 可创建数据库数量 |
| 关联服务器 | 指定服务器或自动负载均衡 |

### 主机管理

- 查看所有主机实例
- 暂停/恢复主机
- 修改到期时间
- 删除主机

---

## 域名托管商系统

托管商系统允许用户申请成为托管商，添加自己的DNS渠道和域名，其他用户购买时收益自动分成。

### 托管申请

1. 用户在个人中心申请成为托管商
2. 填写申请理由
3. 管理员审核申请

### 托管商管理

管理员可以：
- 审核托管申请
- 查看托管商列表
- 暂停/恢复托管商权限
- 设置抽成比例

### 托管商功能

托管商可以：
- 添加自己的DNS渠道
- 添加域名（关联渠道）
- 创建套餐
- 查看收益和交易记录

### 收益分成

- 平台设置默认抽成比例
- 可为每个托管商设置独立抽成比例
- 用户购买托管商域名时，收益自动分配

---

## Telegram机器人

### 配置机器人

1. 在Telegram中找 @BotFather 创建机器人
2. 获取Bot Token
3. 在管理后台 **Telegram设置** 中填入Token
4. 机器人随项目启动自动运行

### 机器人功能

- 用户绑定账号
- 查看域名列表
- 购买域名（按钮交互）
- 购买虚拟主机
- 查看余额和消费记录
- 卡密充值

### 命令列表

| 命令 | 说明 |
|------|------|
| /start | 开始使用 |
| /bind | 绑定账号 |
| /domains | 我的域名 |
| /balance | 查看余额 |
| /help | 帮助信息 |
